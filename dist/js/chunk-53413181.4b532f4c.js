(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-53413181"],{"2bd0":function(t,e,s){"use strict";s("e0e0")},c740:function(t,e,s){"use strict";var i=s("23e7"),o=s("b727").findIndex,a=s("44d2"),n="findIndex",r=!0;n in[]&&Array(1)[n]((function(){r=!1})),i({target:"Array",proto:!0,forced:r},{findIndex:function(t){return o(this,t,arguments.length>1?arguments[1]:void 0)}}),a(n)},e0e0:function(t,e,s){},f771:function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"container",staticStyle:{position:"relative"}},[s("h2",{staticClass:"page-title"},[t._v("أكواد الطلبة")]),s("br"),s("br"),s("section",[s("h3",{staticClass:"subtitle"},[t._v("أضافة أكواد متعددة")]),s("div",{staticClass:"row justify-content-center align-items-center _inputs1",attrs:{dir:"rtl"}},[s("div",{staticClass:"col-md-3"},[s("div",{staticClass:"form-group"},[s("label",[t._v("عدد الاكواد")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.multiCodes.count,expression:"multiCodes.count"}],staticClass:"form-control",attrs:{type:"number",placeholder:"عدد الأكواد المطلوبة"},domProps:{value:t.multiCodes.count},on:{input:function(e){e.target.composing||t.$set(t.multiCodes,"count",e.target.value)}}})])]),s("div",{staticClass:"col-md-3"},[s("div",{staticClass:"form-group"},[s("label",[t._v("مدة الصلاحية")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.multiCodes.duration,expression:"multiCodes.duration"}],staticClass:"form-control",attrs:{type:"number",placeholder:"مدة الصلاحية من بدأ الأستخدام"},domProps:{value:t.multiCodes.duration},on:{input:function(e){e.target.composing||t.$set(t.multiCodes,"duration",e.target.value)}}})])]),"all"==t.page?s("div",{staticClass:"col-md-3"},[s("div",{staticClass:"form-group"},[s("label",[t._v("المرحلة الدراسية")]),s("select",{directives:[{name:"model",rawName:"v-model",value:t.multiCodes.stage,expression:"multiCodes.stage"}],staticClass:"form-control",on:{change:function(e){var s=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.multiCodes,"stage",e.target.multiple?s:s[0])}}},t._l(t.stages,(function(e){return s("option",{key:e.value,domProps:{value:e.value}},[t._v(" "+t._s(e.text)+" ")])})),0)])]):t._e(),"all"==t.page?s("div",{staticClass:"col-md-3"},[s("div",{staticClass:"form-group"},[s("label",[t._v("الوحدة ")]),s("select",{directives:[{name:"model",rawName:"v-model",value:t.multiCodes.section,expression:"multiCodes.section"}],staticClass:"form-control",on:{change:function(e){var s=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.multiCodes,"section",e.target.multiple?s:s[0])}}},[s("option",{domProps:{value:0}},[t._v("لكل الوحدات")]),t._l(t.sections,(function(e){return s("option",{key:e._id,domProps:{value:e.number}},[t._v(" "+t._s(e.name)+" ")])}))],2)])]):t._e(),s("div",{staticClass:"col-md-3"},[t.uploading?s("div",{staticClass:"center"},[s("loading")],1):t._e(),s("button",{staticClass:"btn btn-success",on:{click:t.addMultiCodes}},[t._v("أضافة")])])])]),s("br"),s("hr"),s("section",[s("h3",{staticClass:"subtitle"},[t._v("ابحث عن الكود")]),s("div",{staticClass:"row justify-content-center align-items-end _inputs1",attrs:{dir:"rtl"}},["all"==t.page?s("div",{staticClass:"col-md-3"},[s("div",{staticClass:"form-group"},[s("label",[t._v("المرحلة الدراسية")]),s("select",{directives:[{name:"model",rawName:"v-model",value:t.filter.stage,expression:"filter.stage"}],staticClass:"form-control",on:{change:function(e){var s=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.filter,"stage",e.target.multiple?s:s[0])}}},[s("option",{attrs:{value:""}}),t._l(t.stages,(function(e){return s("option",{key:e.value,domProps:{value:e.value}},[t._v(" "+t._s(e.text)+" ")])}))],2)])]):t._e(),"all"==t.page?s("div",{staticClass:"col-md-3"},[s("div",{staticClass:"form-group"},[s("label",[t._v("الوحدة")]),s("select",{directives:[{name:"model",rawName:"v-model",value:t.filter.section,expression:"filter.section"}],staticClass:"form-control",on:{change:function(e){var s=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.filter,"section",e.target.multiple?s:s[0])}}},[t._l(t.filter_sections,(function(e){return s("option",{key:e._id,domProps:{value:e.number}},[t._v(" "+t._s(e.name)+" ")])})),s("option",{attrs:{value:"all"}},[t._v("all")])],2)])]):t._e(),s("div",{staticClass:"col-md-3"},[s("div",{staticClass:"form-group"},[s("label",[t._v("حالة الأكواد")]),s("select",{directives:[{name:"model",rawName:"v-model",value:t.filter.status,expression:"filter.status"}],staticClass:"form-control",on:{change:function(e){var s=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.filter,"status",e.target.multiple?s:s[0])}}},[s("option",{attrs:{value:"all"}},[t._v("الكل")]),s("option",{attrs:{value:"1"}},[t._v("مستخدمة")]),s("option",{attrs:{value:"2"}},[t._v("غير مستخدمة")])])])]),s("div",{staticClass:"col-md-3"},[s("div",{staticClass:"form-group"},[s("label",[t._v("ابحث عن الاكواد بمدة الصلاحية")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.filter.duration,expression:"filter.duration"}],staticClass:"form-control",attrs:{type:"number"},domProps:{value:t.filter.duration},on:{input:function(e){e.target.composing||t.$set(t.filter,"duration",e.target.value)}}})])]),s("div",{staticClass:"col-md-3"},[s("div",{staticClass:"form-group"},[s("label",[t._v("ابحث بالكود")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.filter.code,expression:"filter.code"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.filter.code},on:{input:function(e){e.target.composing||t.$set(t.filter,"code",e.target.value)}}})])]),s("div",{staticClass:"col-md-3"},[s("div",{staticClass:"form-group"},[s("label",[t._v("ابحث بأسم مستخدم الكود")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.filter.username,expression:"filter.username"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.filter.username},on:{input:function(e){e.target.composing||t.$set(t.filter,"username",e.target.value)}}})])]),s("div",{staticClass:"col-md-3"},[s("div",{staticClass:"form-group"},[s("label",[t._v("تاريخ صلاحية من يوم")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.filter.from,expression:"filter.from"}],staticClass:"form-control",attrs:{type:"date"},domProps:{value:t.filter.from},on:{input:function(e){e.target.composing||t.$set(t.filter,"from",e.target.value)}}})])]),s("div",{staticClass:"col-md-3"},[s("div",{staticClass:"form-group"},[s("label",[t._v("تاريخ صلاحية حتى يوم")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.filter.to,expression:"filter.to"}],staticClass:"form-control",attrs:{type:"date"},domProps:{value:t.filter.to},on:{input:function(e){e.target.composing||t.$set(t.filter,"to",e.target.value)}}})])]),s("div",{staticClass:"col-md-3"},[s("div",{staticClass:"form-group"},[t.loading?s("div",{staticClass:"center"},[s("loading")],1):t._e(),s("button",{staticClass:"btn btn-success",on:{click:t.getStageCodes}},[t._v("بحث")])])])]),s("hr"),s("hr"),s("div",{staticClass:"row justify-content-center"},[s("div",{staticClass:"col-md-3"},[s("button",{staticClass:"btn btn-danger",on:{click:t.deleteCodes}},[t._v(" مسح الأكواد الظاهرة أمامك ")])]),s("div",{staticClass:"col-md-3"},[s("button",{staticClass:"btn btn-success",on:{click:t.downloadCodes}},[t._v(" تحميل الأكواد في ملف txt ")])])])]),s("br"),s("hr"),s("div",{attrs:{id:"findCodes"}},[s("server-responsive-table",{attrs:{title:"Codes",api:"/getStageCodes",itemsName:"codes",returnedItems:t.codes,colsTitles:["code","duration","expiration","username","times"],cols:["code","duration","expiration","username","times"],colsTypes:["readonly","readonly","readonly","readonly","readonly"],btns:[{icon:"pencil",method:t.editCode},{icon:"trash",method:t.removeCode}],color:"#555",filter:t.filter,setRowStyle:function(t){return t.times>0?"border: 6px solid orange":""}},on:{itemsFetched:t.setCodesFromTable}})],1),s("hr"),s("div",{staticClass:"container"},[s("h3",{staticClass:"subtitle2 text-center text-medium"},[t._v(" تعديل الاكواد الظاهرة لتاريخ صلاحية معين ")]),s("br"),s("div",{staticClass:"row justify-content center border",attrs:{dir:"rtl"}},[s("div",{staticClass:"col-md-4"},[s("div",{staticClass:"form-group"},[s("label",[t._v("Expiration Date")]),s("input",{ref:"expire_update",staticClass:"form-control",attrs:{type:"date"}})])]),s("div",{staticClass:"col-md-4"},[s("button",{staticClass:"btn btn-3",attrs:{disabled:t.expireUpdating},on:{click:t.updateExpiration}},[t._v(" "+t._s(t.expireUpdating?"updating...":"update")+" ")])])])]),t.openEdit?s("div",{staticClass:"__modal p-3",class:{open:t.openEdit}},[s("div",{staticClass:"container"},[s("h3",{staticClass:"subtitle2",staticStyle:{color:"#888"}},[t._v("تعديل الكود")]),s("div",{staticClass:"row justify-content-center align-items-end",attrs:{dir:"rtl"}},[s("div",{staticClass:"col-md-2"},[s("div",{staticClass:"code"},[s("label",[t._v("الكود")]),s("h4",{staticClass:"text-center"},[t._v(t._s(t.code.code))])])]),s("div",{staticClass:"col-md-3"},[s("div",{staticClass:"form-group"},[s("label",[t._v("تم الأستخدام بواسطة")]),s("h4",{staticClass:"text-center"},[t._v(t._s(t.code.username))])])]),"all"==t.page?s("div",{staticClass:"col-md-3"},[s("div",{staticClass:"form-group"},[s("label",[t._v("المرحلة الدراسية")]),s("h4",{staticClass:"text-center"},[t._v(t._s(t._f("stage")(t.code.stage)))])])]):t._e(),"all"==t.page?s("div",{staticClass:"col-md-2"},[s("div",{staticClass:"form-group"},[s("label",[t._v("الوحدة")]),s("select",{directives:[{name:"model",rawName:"v-model",value:t.code.section,expression:"code.section"}],staticClass:"form-control",on:{change:function(e){var s=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.code,"section",e.target.multiple?s:s[0])}}},[s("option",{domProps:{value:0}},[t._v("all")]),t._l(t.$store.getters.sections.filter((function(e){return e.stage==t.code.stage})),(function(e){return s("option",{key:e._id,domProps:{value:e.number}},[t._v(" "+t._s(e.name)+" ")])}))],2)])]):t._e(),s("div",{staticClass:"col-md-2"},[s("div",{staticClass:"form-group"},[s("label",[t._v("انتهاء الصلاحية")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.code.expiration,expression:"code.expiration"}],staticClass:"form-control",attrs:{type:"date"},domProps:{value:t.code.expiration},on:{input:function(e){e.target.composing||t.$set(t.code,"expiration",e.target.value)}}})])])]),s("hr",{staticStyle:{background:"#fff"}}),s("br"),s("div",{staticClass:"row justify-content-center"},[t.updating?s("div",{staticClass:"col-md-12"},[s("div",{staticClass:"center"},[s("loading")],1)]):t._e(),s("div",{staticClass:"col-md-3"},[s("button",{staticClass:"btn btn-success",on:{click:t.updateCode}},[t._v("update")])]),s("div",{staticClass:"col-md-3"},[s("button",{staticClass:"btn btn-danger",on:{click:function(e){t.openEdit=!t.openEdit}}},[t._v("cancel")])])])])]):t._e(),s("app-iframe",{attrs:{src:t.$store.getters.expVideos.codes}})],1)},o=[],a=(s("99af"),s("4de4"),s("7db0"),s("c740"),s("a15b"),s("d81d"),s("b0c0"),s("2909")),n=s("5530"),r=s("bc3a"),l=s.n(r),d={components:{},created:function(){"lessons-codes"==this.$route.name&&(this.page="lessons",this.lessonId=this.$route.params.lessonId,this.filter.lessonId=this.$route.params.lessonId)},mounted:function(){this.filter.stage="6",this.multiCodes.stage="6"},data:function(){return{loading:!1,uploading:!1,updating:!1,expireUpdating:!1,page:"all",lessonId:null,codes:[],sections:[],filter_sections:[],filteredCodes:[],multiCodes:{stage:"",section:0,duration:15,count:1},openEdit:!1,code:{_id:null,code:null,stage:null,section:null,expiration:""},filter:{stage:"",section:"all",duration:0,code:"",username:"",status:"all",from:"",to:"",lessonId:""}}},watch:{"filter.stage":function(t){this.filter_section=0,this.filter_sections=this.$store.getters.sections.filter((function(e){return e.stage==t})),this.filter_sections.push({number:0,name:"الأكواد العامة"})},"multiCodes.stage":function(t){this.sections=this.$store.getters.sections.filter((function(e){return e.stage==t}))}},computed:{stages:function(){return this.$store.getters.stages}},methods:{setCodesFromTable:function(t){this.filteredCodes=t},addMultiCodes:function(){var t=this;if(!this.multiCodes.stage&&!this.lessonId)return alert("اكمل بيانات الكود");this.uploading=!0;var e=this.lessonId?"/addMultiLessonCodes/".concat(this.lessonId):"/addMultiCodes";l.a.post(e,this.multiCodes).then((function(e){if(t.uploading=!1,e.data.err)return alert(e.data.err);t.$store.dispatch("writemessage","تمت الأضافة"),document.getElementById("findCodes").scrollIntoView({behavior:"smooth"});var s={};s.stage=t.multiCodes.stage,s.section=t.multiCodes.section,s.duration=t.multiCodes.duration,s.code="",s.username="",s.status="all",s.to="",s.lessonId=t.filter.lessonId,t.filter=Object(n["a"])({},s)}))},isExpired:function(t){return(new Date).getTime()>new Date(t).getTime()},getStageCodes:function(){this.filter=Object(n["a"])({},this.filter)},deleteCodes:function(){var t=this;if(confirm("!مسح الأكواد نهائيا؟")){document.getElementById("findCodes").scrollIntoView({behavior:"smooth"}),this.loading=!0;var e=this.lessonId?"/deleteLessonCodes":"/deleteExpiredCodes";l.a.post(e,{ids:this.filteredCodes.map((function(t){return t._id}))}).then((function(e){if(t.loading=!1,e.data.err)return alert(e.data.err);t.filter=Object(n["a"])({},t.filter)}))}},downloadCodes:function(){var t=document.createElement("a");t.href="data:text/plain;charset=utf-8,".concat(encodeURIComponent(this.filteredCodes.map((function(t){return t.code})).join("             "),toString())),t.download="codes.txt",t.click()},removeCode:function(t){var e=this;if(confirm("المسح نهائيا؟")){this.removing=!0;var s="/removeCode/".concat(t._id,"/").concat(this.lessonId?"lessons":"general");l.a.delete(s).then((function(s){if(e.removing=!1,s.data.err)return alert(s.data.err);e.filteredCodes.findIndex((function(e){return e._id==t._id}));e.filter=Object(n["a"])({},e.filter)}))}},editCode:function(t){this.code=this.filteredCodes.find((function(e){return e._id==t._id})),this.code&&(this.openEdit=!0)},updateCode:function(){var t=this;this.updating=!0;var e={expiration:this.code.expiration};this.lessonId&&(e["section"]=this.code.section),l.a.post("/updateCode/".concat(this.code._id,"/").concat(this.lessonId?"lessons":"general"),e).then((function(e){if(t.updating=!1,e.data.err)return alert(e.data.err);var s=t.filteredCodes.findIndex((function(e){return e._id==t.code._id}));t.filteredCodes[s]=t.code,t.codes=Object(a["a"])(t.filteredCodes),t.code={},t.openEdit=!1,t.$store.dispatch("writemessage","تم تحديث الكود")}))},updateExpiration:function(){var t=this,e=this.$refs.expire_update.value,s=this.filteredCodes.map((function(t){return t._id}));this.expireUpdating=!0,l.a.post("/updateCodesExpirationDate/".concat(this.lessonId?"lessons":"general"),{expiration:e,ids:s}).then((function(e){if(t.expireUpdating=!1,e.data.err)return alert("Try again");t.$store.dispatch("writemessage","تم التعديل بنجاح"),t.filter=Object(n["a"])({},t.filter)}))}}},c=d,u=(s("2bd0"),s("2877")),m=Object(u["a"])(c,i,o,!1,null,"244d4ec0",null);e["default"]=m.exports}}]);
//# sourceMappingURL=chunk-53413181.4b532f4c.js.map