(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7ccc0072"],{1148:function(t,e,n){"use strict";var s=n("a691"),a=n("1d80");t.exports="".repeat||function(t){var e=String(a(this)),n="",i=s(t);if(i<0||i==1/0)throw RangeError("Wrong number of repetitions");for(;i>0;(i>>>=1)&&(e+=e))1&i&&(n+=e);return n}},"22cc":function(t,e,n){},"2a50":function(t,e,n){"use strict";n("22cc")},"408a":function(t,e,n){var s=n("c6b6");t.exports=function(t){if("number"!=typeof t&&"Number"!=s(t))throw TypeError("Incorrect invocation");return+t}},a434:function(t,e,n){"use strict";var s=n("23e7"),a=n("23cb"),i=n("a691"),r=n("50c4"),c=n("7b0b"),o=n("65f0"),l=n("8418"),u=n("1dde"),h=u("splice"),d=Math.max,f=Math.min,p=9007199254740991,m="Maximum allowed length exceeded";s({target:"Array",proto:!0,forced:!h},{splice:function(t,e){var n,s,u,h,b,g,v=c(this),k=r(v.length),w=a(t,k),C=arguments.length;if(0===C?n=s=0:1===C?(n=0,s=k-w):(n=C-2,s=f(d(i(e),0),k-w)),k+n-s>p)throw TypeError(m);for(u=o(v,s),h=0;h<s;h++)b=w+h,b in v&&l(u,h,v[b]);if(u.length=s,n<s){for(h=w;h<k-s;h++)b=h+s,g=h+n,b in v?v[g]=v[b]:delete v[g];for(h=k;h>k-s+n;h--)delete v[h-1]}else if(n>s)for(h=k-s;h>w;h--)b=h+s-1,g=h+n-1,b in v?v[g]=v[b]:delete v[g];for(h=0;h<n;h++)v[h+w]=arguments[h+2];return v.length=k-s+n,u}})},b680:function(t,e,n){"use strict";var s=n("23e7"),a=n("a691"),i=n("408a"),r=n("1148"),c=n("d039"),o=1..toFixed,l=Math.floor,u=function(t,e,n){return 0===e?n:e%2===1?u(t,e-1,n*t):u(t*t,e/2,n)},h=function(t){var e=0,n=t;while(n>=4096)e+=12,n/=4096;while(n>=2)e+=1,n/=2;return e},d=function(t,e,n){var s=-1,a=n;while(++s<6)a+=e*t[s],t[s]=a%1e7,a=l(a/1e7)},f=function(t,e){var n=6,s=0;while(--n>=0)s+=t[n],t[n]=l(s/e),s=s%e*1e7},p=function(t){var e=6,n="";while(--e>=0)if(""!==n||0===e||0!==t[e]){var s=String(t[e]);n=""===n?s:n+r.call("0",7-s.length)+s}return n},m=o&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!c((function(){o.call({})}));s({target:"Number",proto:!0,forced:m},{toFixed:function(t){var e,n,s,c,o=i(this),l=a(t),m=[0,0,0,0,0,0],b="",g="0";if(l<0||l>20)throw RangeError("Incorrect fraction digits");if(o!=o)return"NaN";if(o<=-1e21||o>=1e21)return String(o);if(o<0&&(b="-",o=-o),o>1e-21)if(e=h(o*u(2,69,1))-69,n=e<0?o*u(2,-e,1):o/u(2,e,1),n*=4503599627370496,e=52-e,e>0){d(m,0,n),s=l;while(s>=7)d(m,1e7,0),s-=7;d(m,u(10,s,1),0),s=e-1;while(s>=23)f(m,1<<23),s-=23;f(m,1<<s),d(m,1,1),f(m,2),g=p(m)}else d(m,0,n),d(m,1<<-e,0),g=p(m)+r.call("0",l);return l>0?(c=g.length,g=b+(c<=l?"0."+r.call("0",l-c)+g:g.slice(0,c-l)+"."+g.slice(c-l))):g=b+g,g}})},bd80:function(t,e,n){"use strict";n.r(e);var s,a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"bg-dark p-3"},[n("div",{staticClass:"row"},[n("div",{staticClass:"col-md-12"},[n("div",{staticClass:"form-group"},[n("label",[t._v("قم برفع فيديو")]),n("input",{ref:"file",staticClass:"form-control",attrs:{type:"file"},on:{change:t.getVideo}})])])]),t.percentage>0?n("div",{staticClass:"progress"},[n("div",{staticClass:"progressbar",style:{width:t.percentage+"%"}},[t._v(" "+t._s(t.percentage)+"% ")])]):t._e(),n("div",{staticClass:"row justify-content-center"},[n("div",{staticClass:"col-md-4"},[n("button",{staticClass:"btn btn-primary w-100",attrs:{disabled:!t.uploadBtnEnabled},on:{click:t.prepareUpload}},[t._v(" Upload ")])]),t.resumeBtnEnabled||t.pauseBtnEnabled?n("div",{staticClass:"col-md-4"},[t.resumeBtnEnabled?n("button",{staticClass:"btn btn-success w-100",on:{click:t.resumePause}},[t._v(" resume ")]):t._e(),t.pauseBtnEnabled?n("button",{staticClass:"btn btn-secondary w-100",on:{click:t.resumePause}},[t._v(" pause ")]):t._e()]):t._e(),n("div",{staticClass:"col-md-4"},[n("button",{staticClass:"btn btn-danger w-100",attrs:{disabled:!t.cancelBtnEnabled},on:{click:t.reset}},[t._v(" Cancel ")])])])])},i=[],r=(n("99af"),n("caad"),n("fb6a"),n("a434"),n("b0c0"),n("b680"),n("ac1f"),n("1276"),n("ade3")),c=(n("56d7"),n("bc3a")),o=n.n(c),l=(s={name:"stream-upload-video",props:["fileName","lessonData"],created:function(){},data:function(){return{file:null,chunks:[],chunksLen:0,uploaded:0,startUpdate:!1,resume:!0}},watch:{formData:function(t){}},filters:{}},Object(r["a"])(s,"watch",{chunks:function(t){t.length>0&&this.startUpdate&&this.upload()}}),Object(r["a"])(s,"computed",{percentage:function(){return this.file?(100-100*this.chunks.length/this.chunksLen).toFixed(1):0},uploadBtnEnabled:function(){return this.chunks.length>0&&0==this.uploaded},resumeBtnEnabled:function(){return this.chunks.length>0&&!this.resume&&this.uploaded>0},pauseBtnEnabled:function(){return this.chunks.length>0&&this.resume&&this.uploaded>0},cancelBtnEnabled:function(){return this.chunks.length>0&&this.uploaded>0}}),Object(r["a"])(s,"methods",{getVideo:function(t){var e=t.target.files[0],n=e.type.split("/")[1];return["mp4","wav"].includes(n)?e.size>Math.pow(10,9)?alert("حجم الملف تجاوز الحجم المسموح به"):(this.file=e,void this.createChunks()):alert("صيغة الفيديو غير صحيحة")},prepareUpload:function(){var t=this;console.log(this.chunksLen),o.a.post("/prepareUpload/",{file:"".concat(this.file.size,"-").concat(this.file.lastModified)}).then((function(e){if(e.data.err)return t.reset(),alert("حاول مرة اخرى");console.log(e.data.chunksLen),e.data.chunksLen>0&&t.chunks.splice(0,e.data.chunksLen),t.upload()}))},upload:function(){var t=this;if(0!=this.chunks.length){if(!this.lessonData.name||!this.lessonData.section||!this.lessonData.stage)return alert("كمل باقي البيانات وأرفع الفيديو");if(this.resume){this.startUpdate=!0;var e=new FormData;e.set("isLast",1==this.chunks.length),e.set("fileName",this.fileName),e.set("tmpName","tmp-".concat(this.chunksLen-this.chunks.length+1,"-").concat(this.file.size,"-").concat(this.file.lastModified).concat(1==this.chunks.length?"-last":"")),e.set("chunk",this.chunks[0],this.file.name+".chunk");var n={method:"POST",url:"/uploadVideoByChunks",data:e,headers:{"Content-Type":"application/octet-stream"},onUploadProgress:function(e){t.uploaded+=e.loaded}};o()(n).then((function(e){t.chunks.shift(),e.data.done&&(t.$emit("uploaded",e.data.videoFile),t.reset())})).catch((function(t){return console.log(t)}))}}},createChunks:function(){var t=this.file.size,e=10*Math.pow(10,5),n=Math.ceil(t/e);this.chunksLen=n;for(var s=0;s<n;s++){var a=this.file.slice(s*e,Math.min(s*e+e,this.file.size),this.file.type);this.chunks.push(a)}},resumePause:function(){this.resume=!this.resume,this.resume&&this.upload()},reset:function(){this.chunks=[],this.chunksLen=0,this.file=null,this.uploaded=0,localStorage.removeItem("chunks"),this.resume=!0,this.startUpdate=!1,this.$refs.file.value=""}}),s),u=l,h=(n("2a50"),n("2877")),d=Object(h["a"])(u,a,i,!1,null,"018879aa",null);e["default"]=d.exports}}]);
//# sourceMappingURL=chunk-7ccc0072.1295fa6d.js.map